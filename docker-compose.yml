services:
  frontend:
    build:
      context: .
      dockerfile: Dockerfile.frontend
    restart: unless-stopped
    networks:
      - fse-net

  backend:
    build:
      context: .
      dockerfile: Dockerfile.backend
    environment:
      FORTY_TWO_UID: ${FORTY_TWO_UID}
      FORTY_TWO_SECRET: ${FORTY_TWO_SECRET}
      FORTY_TWO_SCOPE: ${FORTY_TWO_SCOPE:-public}
      FORTY_TWO_TOKEN_URL: ${FORTY_TWO_TOKEN_URL:-https://api.intra.42.fr/oauth/token}
      FORTY_TWO_API_BASE: ${FORTY_TWO_API_BASE:-https://api.intra.42.fr/v2}
      FSE_API_BASE: ${FSE_API_BASE:-/api/42}
    restart: unless-stopped
    networks:
      - fse-net

  nginx:
    image: nginx:1.27-alpine
    depends_on:
      - frontend
      - backend
    expose:
      - '80'
    volumes:
      - /home/heinz/Code/42-pan-bagnat/repos/fse-generator/nginx.conf:/etc/nginx/nginx.conf:ro
    restart: unless-stopped
    networks:
      - fse-net

networks:
  fse-net:
    driver: bridge
